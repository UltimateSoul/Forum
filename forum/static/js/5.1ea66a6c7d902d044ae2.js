webpackJsonp([5],{"+2Fi":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=a("Dd8w"),r=a.n(s),n=a("mtWM"),i=a.n(n),u=a("NYxO"),m={name:"Team",data:function(){return{team:{avatar:"",baseInfo:"",totalMembers:0,createdAt:"",description:"",id:0,name:""},ranks:[],maxRanksNumber:15,members:[],teamRequests:[],memberFields:["avatar","username","game_nickname","rank"],owner:{},showTeamMembers:!1,showTeamRequests:!1,requestForUserExists:!1}},created:function(){var e=this;this.$store.dispatch("fetchUser"),this.getData(this.$route.params.teamID).then(function(){e.isOwner?e.getTeamRequests(1):e.checkIfRequestExists(e.$route.params.teamID)}),this.getTeamRanks(this.$route.params.teamID)},watch:{$route:function(e,t){this.getData(e.params.teamID),this.getTeamRanks(e.params.teamID)}},methods:{getData:function(e){var t=this;return i.a.get("teams/"+e+"/").then(function(e){switch(e.status){case 200:t.members=e.data.members,t.owner=e.data.owner,t.team.avatar=e.data.avatar,t.team.baseInfo=e.data.base_info,t.team.id=e.data.id,t.team.name=e.data.name,t.team.description=e.data.description,t.team.createdAt=e.data.created_at,t.team.totalMembers=e.data.total_members}})},patchRequest:function(e,t){var a={approved:e};return i.a.patch("user-team-requests/"+t+"/",a)},getTeamRequests:function(e){var t=this,a={teamID:this.team.id,page:e};return i.a.get("user-team-requests/get-requests-for-team/",{params:a}).then(function(e){switch(e.status){case 200:t.teamRequests=e.data.results}})},checkIfRequestExists:function(e){var t=this;return i.a.get("user-team-requests/is-request-exist/",{params:{teamID:e}}).then(function(e){switch(e.status){case 200:t.requestForUserExists=!0;break;case 404:t.requestForUserExists=!1;break;default:t.requestForUserExists=!1}})},getTeamRanks:function(e){var t=this;return i.a.get("ranks/get_team_ranks/",{params:{teamID:e}}).then(function(e){switch(e.status){case 200:t.ranks=e.data}})},showUserRequestModal:function(){this.$modal.show("user-request-for-team")},hideUserRequestModal:function(){this.$modal.hide("user-request-for-team")},showTeamRequestModal:function(){this.$modal.show("team-requests")},hideTeamRequestModal:function(){this.$modal.hide("team-requests")},joinTeam:function(){var e=this,t={team:this.$route.params.teamID};i.a.post("user-team-requests/",t).then(function(t){switch(t.status){case 201:e.showUserRequestModal();break;case 222:break;case 403:console.log("Unauthorized or forbidden");break;case 400:break;default:console.log("default behaviour")}})},goToEditTeam:function(){this.$router.push({name:"edit-team",params:{teamID:this.$route.params.teamID}})}},computed:r()({},Object(u.b)(["getUserData","isHasTeam"]),{isOwner:function(){return this.owner.pk===this.getUserData.userID},isMember:function(){var e=this.getUserData.userID;return this.members.forEach(function(t){return t.user.pk===e}),!1},teamRequestsButtonText:function(){return this.teamRequests.length?"Show Team Requests":"No team requests"}})},o={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("modal",{attrs:{name:"user-request-for-team"}},[a("div",{staticClass:"m-5 text-center"},[a("h1",[e._v("\n        Thank you!\n      ")]),e._v(" "),a("h5",[e._v("\n        Captain of this team will consider your request soon!\n      ")]),e._v(" "),a("b-button",{attrs:{variant:"success"},on:{click:e.hideUserRequestModal}},[e._v("Ok")])],1)]),e._v(" "),a("modal",{attrs:{name:"team-requests",scrollable:!0,width:"50%",height:"50%",draggable:!0}},e._l(e.teamRequests,function(t){return a("div",[a("b-card",{staticClass:"mb-2",staticStyle:{"max-width":"50rem"},attrs:{title:t.user.username,"img-src":t.user.avatar,"img-alt":"Image","img-top":"",tag:"article"}},[a("b-button",{attrs:{variant:"success"},on:{click:function(a){return e.patchRequest(!0,t.id)}}},[e._v("Accept Request")]),e._v(" "),a("b-button",{attrs:{variant:"danger"},on:{click:function(a){return e.patchRequest(!1,t.id)}}},[e._v("Reject Request")])],1)],1)}),0),e._v(" "),a("b-row",[a("b-col",{attrs:{lg:"8"}},[e.isOwner?a("b-button",{staticClass:"float-left",attrs:{variant:"success"},on:{click:e.goToEditTeam}},[e._v("\n        Edit Team\n      ")]):e._e()],1),e._v(" "),a("b-col",{attrs:{lg:"4"}},[e.isOwner&&e.teamRequests.length?a("b-button",{staticClass:"float-right",attrs:{variant:"success"},on:{click:e.showTeamRequestModal}},[e._v("\n        "+e._s(e.teamRequestsButtonText)+"\n      ")]):e._e(),e._v(" "),e.isOwner&&!e.teamRequests.length?a("b-button",{staticClass:"float-right",attrs:{variant:"success",disabled:""},on:{click:e.showTeamRequestModal}},[e._v("\n        "+e._s(e.teamRequestsButtonText)+"\n      ")]):e._e(),e._v(" "),e.isMember||e.isOwner||e.requestForUserExists?e._e():a("b-button",{staticClass:"float-right",attrs:{variant:"success"},on:{click:e.joinTeam}},[e._v("Join Team\n      ")])],1)],1),e._v(" "),a("div",[a("img",{attrs:{src:e.team.avatar,height:"250",width:"250"}}),e._v(" "),a("hr"),e._v(" "),a("h1",[e._v("\n      "+e._s(e.team.name)+"\n    ")]),e._v(" "),a("hr"),e._v(" "),a("h5",[e._v("\n      "+e._s(e.team.description)+"\n    ")]),e._v(" "),a("hr"),e._v(" "),a("div",{staticClass:"clicable",on:{click:function(t){e.showTeamMembers=!e.showTeamMembers}}},[a("h3",[e._v("Team Members:")])]),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:e.showTeamMembers,expression:"showTeamMembers"}]},[a("b-table",{attrs:{striped:"",hover:"",items:e.members,fields:e.memberFields},scopedSlots:e._u([{key:"cell(avatar)",fn:function(e){return[e.item.user.avatar?a("img",{attrs:{src:e.item.user.avatar,height:"100",width:"100"}}):a("img",{attrs:{src:"http://0.0.0.0:5000/static/images/default.jpg",height:"100",width:"100"}})]}},{key:"cell(username)",fn:function(t){return[e._v("\n          "+e._s(t.item.user.username)+"\n        ")]}},{key:"cell(game_nickname)",fn:function(t){return[e._v("\n          "+e._s(t.item.user.game_nickname)+"\n        ")]}},{key:"cell(rank)",fn:function(t){return[t.item.rank?a("div",[e._v("\n            "+e._s(t.item.rank.name)+"\n          ")]):e._e()]}}])})],1)])],1)},staticRenderFns:[]};var c=a("VU/8")(m,o,!1,function(e){a("eCA0")},"data-v-700675e1",null);t.default=c.exports},eCA0:function(e,t){}});
//# sourceMappingURL=5.1ea66a6c7d902d044ae2.js.map