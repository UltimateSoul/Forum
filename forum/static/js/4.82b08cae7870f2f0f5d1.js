webpackJsonp([4],{"+7QJ":function(t,s){},HyuL:function(t,s,i){"use strict";Object.defineProperty(s,"__esModule",{value:!0});var e=i("Dd8w"),o=i.n(e),a=i("mtWM"),n=i.n(a),r=i("NYxO"),c={name:"Topic",data:function(){return{topicID:this.$route.params.topicID,topic:{title:"",description:"",body:"",totalLikes:0,isLiked:!1},author:{avatar:"",gameNickName:"",username:"",pk:0},posts:[],buttonsEngine:{},postText:"",commentText:"",currentPage:1}},created:function(){this.getTopicData(),this.getTopicPosts(1)},methods:{getTopicData:function(){var t=this;n.a.get("topics/"+this.topicID+"/").then(function(s){t.topic.title=s.data.title,t.topic.description=s.data.description,t.topic.body=s.data.body,t.topic.totalLikes=s.data.total_likes,t.topic.isLiked=s.data.is_liked,t.author.avatar=s.data.author.avatar,t.author.gameNickName=s.data.author.game_nickname,t.author.username=s.data.author.username,t.author.pk=s.data.author.pk,t.title=s.data.title})},getTopicPosts:function(t){var s=this;n.a.get("posts/",{params:{topic:this.topicID,page:t}}).then(function(t){s.posts=t.data.results,s.posts.forEach(function(t){var i="button-"+t.id;s.$set(s.buttonsEngine,i,{isOpen:!1})})})},editTopic:function(){this.$router.push({name:"topic-editing",params:{section:this.$route.params.section,topicID:this.topicID}})},saveComment:function(t){var s=this,i={body:this.commentText,post:t};n.a.post("comments/",i).then(function(t){switch(t.status){case 201:s.commentText="",s.getTopicPosts(s.currentPage)}})},savePost:function(){var t=this,s={body:this.postText,topic:this.topicID};n.a.post("posts/",s).then(function(s){switch(s.status){case 201:t.postText="",t.getTopicPosts(t.currentPage)}})},likeOrUnlikePostClick:function(t,s){var i=this;s?n.a.post("posts/"+t+"/unlike/").then(function(t){switch(t.status){case 200:i.getTopicPosts(i.currentPage)}}):n.a.post("posts/"+t+"/like/").then(function(t){switch(t.status){case 201:i.getTopicPosts(i.currentPage)}})},likeOrUnlikeCommentClick:function(t,s){var i=this;s&&n.a.post("comments/"+t+"/unlike/").then(function(t){switch(t.status){case 200:i.getTopicPosts(i.currentPage)}}),n.a.post("comments/"+t+"/like/").then(function(t){switch(t.status){case 201:i.getTopicPosts(i.currentPage)}})},likeOrUnlikeTopicClick:function(){var t=this;this.topic.isLiked?n.a.post("topics/"+this.topicID+"/unlike/").then(function(s){switch(s.status){case 200:t.getTopicData()}}):n.a.post("topics/"+this.topicID+"/like/").then(function(s){switch(s.status){case 201:t.getTopicData()}})}},computed:o()({},Object(r.b)(["isMainUser","getUserData"]),{getCommentsButtonText:function(){var t=this;return function(s){return console.log("getCommentsButtonText"),t.buttonsEngine[s].isOpen?"Collapse":"Expand"}}})},u={render:function(){var t=this,s=t.$createElement,i=t._self._c||s;return i("div",[i("h1",[t._v(t._s(t.topic.title))]),t._v(" "),i("hr"),t._v(" "),i("h5",[t._v(t._s(t.topic.description))]),t._v(" "),i("div",[i("b-card",{staticClass:"overflow-hidden",attrs:{"no-body":""}},[i("b-row",{attrs:{"no-gutters":""}},[i("b-col",{attrs:{md:"2"}},[i("b-card-img",{staticClass:"rounded-1",attrs:{src:t.author.avatar}}),t._v(" "),i("h5",[t._v(t._s(t.author.username))]),t._v(" "),i("h5",[t._v(t._s(t.author.gameNickName))])],1),t._v(" "),i("b-col",{attrs:{md:"10"}},[i("b-card-body",[i("b-card-text",[t._v("\n              "+t._s(t.topic.body)+"\n            ")])],1)],1)],1),t._v("\n      Likes: "+t._s(t.topic.totalLikes)+"\n      "),i("b-button",{attrs:{variant:"primary",pressed:t.topic.isLiked,id:"like-topic-button-"+t.topicID},on:{click:function(s){return t.likeOrUnlikeTopicClick()}}},[t._v("\n        Like\n      ")])],1),t._v(" "),t.isMainUser(t.author.pk)?i("div",{staticClass:"button-control"},[i("b-button",{on:{click:t.editTopic}},[t._v("Edit")])],1):t._e(),t._v(" "),t._l(t.posts,function(s){return i("div",{key:s.id},[i("hr"),t._v(" "),i("b-card",{staticClass:"overflow-hidden",attrs:{"no-body":""}},[i("b-row",{attrs:{"no-gutters":""}},[i("b-col",{attrs:{md:"2"}},[i("b-card-img",{staticClass:"rounded-1",attrs:{src:s.author.avatar}})],1),t._v(" "),i("b-col",{attrs:{md:"10"}},[i("b-card-body",{attrs:{title:s.author.username}},[i("b-card-text",[t._v("\n                "+t._s(s.body)+"\n              ")])],1)],1),t._v("\n          Likes: "+t._s(s.total_likes)+"\n        ")],1),t._v(" "),i("div",{staticClass:"button-control"},[i("b-button",{attrs:{variant:"primary",pressed:s.is_liked,id:"like-post-button-"+s.id},on:{click:function(i){return t.likeOrUnlikePostClick(s.id,s.is_liked)}}},[t._v("\n            Like\n          ")])],1)],1),t._v(" "),i("div",{staticClass:"button-control"},[i("b-button",{attrs:{variant:"primary",id:"button-"+s.id},on:{click:function(i){t.buttonsEngine["button-"+s.id].isOpen=!t.buttonsEngine["button-"+s.id].isOpen}}},[t._v("\n          "+t._s(t.getCommentsButtonText("button-"+s.id))+"\n        ")])],1),t._v(" "),t.buttonsEngine["button-"+s.id].isOpen?i("div",[t._l(s.comments,function(s){return i("div",{staticClass:"message-range"},[i("b-card",{staticClass:"overflow-hidden",attrs:{"no-body":""}},[i("b-row",{attrs:{"no-gutters":""}},[i("b-col",{attrs:{md:"2"}},[i("b-card-img",{staticClass:"rounded-1",attrs:{src:s.author.avatar}})],1),t._v(" "),i("b-col",{attrs:{md:"10"}},[i("b-card-body",{attrs:{title:s.author.username}},[i("b-card-text",[t._v("\n                    "+t._s(s.body)+"\n                  ")])],1)],1)],1),t._v("\n            Likes: "+t._s(s.total_likes)+"\n            "),i("div",{staticClass:"button-control"},[i("b-button",{attrs:{pressed:s.is_liked,variant:"primary",id:"like-comment-button-"+s.id},on:{click:function(i){return t.likeOrUnlikeCommentClick(s.id,s.is_liked)}}},[t._v("\n                Like\n              ")])],1)],1)],1)}),t._v(" "),i("div",{staticClass:"message-range"},[i("b-form-textarea",{attrs:{id:"textarea",placeholder:"Enter comment...",rows:"3","max-rows":"6"},model:{value:t.commentText,callback:function(s){t.commentText=s},expression:"commentText"}}),t._v(" "),i("b-button",{attrs:{variant:"primary",id:"button-comment"+s.id},on:{click:function(i){return t.saveComment(s.id)}}},[t._v("\n            Post\n          ")])],1)],2):t._e()],1)}),t._v(" "),i("div",{staticClass:"message-range"},[i("b-form-textarea",{attrs:{id:"textarea",placeholder:"Enter post...",rows:"3","max-rows":"6"},model:{value:t.postText,callback:function(s){t.postText=s},expression:"postText"}}),t._v(" "),i("b-button",{attrs:{variant:"primary"},on:{click:t.savePost}},[t._v("\n        Post\n      ")])],1)],2)])},staticRenderFns:[]};var d=i("VU/8")(c,u,!1,function(t){i("+7QJ")},"data-v-fa8b22ac",null);s.default=d.exports}});
//# sourceMappingURL=4.82b08cae7870f2f0f5d1.js.map